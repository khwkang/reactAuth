<!DOCTYPE html>
<html>
<head>
  <meta charset=utf-8>
  <title>State</title>
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
</head>
<body>

  <!-- container node -->
  <div id="app"></div>

  <script src="/bower_components/react/react.min.js"></script>
  <script src="/bower_components/react/JSXTransformer.js"></script>
  <script src="/bower_components/jquery/dist/jquery.min.js"></script>
  <script type="text/jsx">
  /** @jsx React.DOM */

  // authenticate via ajax call
  var loadProfile = function(){
    // ajax promise
  }


  // defining the component 
  var AppComponent = React.createClass({

    // handling login button event 
    handleLogin: function (e) {
      var username = this.refs.username.getDOMNode().value;
      var password = this.refs.password.getDOMNode().value;

      // this.setState({
      //   userName: username
      // });

      // console.log(this);
      // console.log(username);
      // console.log(password);
    },

    // define the state values 
    getInitialState: function () {

      // TODO: change titleMessage based on username
      return {
        isVisible: true,
        message: "hello world"
        // userName: "ha"
      }
    },

    render: function() {
      var inlineStyle = {
        display: this.state.isVisible ? 'block' : 'none'
      };
      
      // check if user is authenticated
      var authenticated = true;

      var message = this.state.message;

      // returning node 
      if (authenticated) {
        return (
          <div className="container jumbotron" style={inlineStyle}>
          <h2>Login</h2>
            <input ref="username" type = "text"/>
            <input ref="password" type = "password"/>
            <button className="btn btn-primary" onClick={this.handleLogin}>Login</button>
            <Dashboard message = {message} />
            <Logout />
          </div>
        );
      } else {
        return (
          <div className="container jumbotron" style={inlineStyle}>
          <h2>Dashboard</h2>
            <Dashboard message = {message} />
          </div>
        );
      }

    }
  });
  
  // <h2>{ this.state.titleMessage }</h2>
  // <h2>{ this.props.titleMessage }</h2>


  // defining the sub-component to show when the session begins
  var Dashboard = React.createClass({

    // validation 
    propTypes: function() {
      message: React.PropTypes.string.isRequired
    },

    // setting default prop
    getDefaultProps: function() {
      return {
        message: "Its good to see you"
      }
    },

    render: function() {
      return (
        <div>{this.props.message}</div>
      );
    }
  });

  // defining sub-component to show when the session expires
  var Logout = React.createClass({
    // validation 
    render: function() {
      return (
        <div>You have succssfuly logged out!</div>
      );
    }
  });

  var reactComponent = React.render(
    // render the component 
    // <AppComponent titleMessage={message} />,
    <AppComponent/>,
    // defining the container for the component
    document.getElementById('app'),
    // function invoked after rendering is complete 
    function() {
      console.log("rendering completed")
    }
  );

  </script>
</body>
</html>